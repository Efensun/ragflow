[uwsgi]
# 基本配置
module = api.apps:app
chdir = %(PYTHONPATH)
# home = %(PYTHONPATH)/.venv  # 如果有虚拟环境，取消注释并修正路径

# 网络配置
http = 0.0.0.0:9380
http-keepalive = 1
http-auto-chunked = 1

# 进程和线程配置
master = true
processes = 4
threads = 2
enable-threads = true

# 内存和性能优化
buffer-size = 32768
memory-report = true
max-requests = 1000
max-requests-delta = 50
reload-on-rss = 512

# 预加载应用
preload-app = true
lazy-apps = false

# 日志配置
logto = /var/log/uwsgi/coinex_customer_chatbot_server.log
log-maxsize = 100000000
log-backupcount = 3
log-date = %%Y-%%m-%%d %%H:%%M:%%S
disable-logging = false

# 安全配置
uid = nobody
gid = nogroup
chmod-socket = 666
vacuum = true

# PID文件
pidfile = /var/run/uwsgi/coinex_customer_chatbot_server.pid

# 环境变量
env = PYTHONPATH=%(PYTHONPATH)
env = LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/
env = http_proxy=
env = https_proxy=
env = no_proxy=
env = HTTP_PROXY=
env = HTTPS_PROXY=
env = NO_PROXY=

# uWSGI内部配置
die-on-term = true
need-app = true 